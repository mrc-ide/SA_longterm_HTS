library(tidyr)
library(dplyr)
library(ggplot2)
test_costs_only <- cost_summary %>%
filter(indicator %in% c("cost_general_hts_neg",
"cost_general_hts_pos",
"cost_anc_test_neg",
"cost_anc_test_pos",
"cost_total_testing"),
scenario %in% c("intervention"),
test_reduction %in% c(0, 25, 50, 75, 100),
year >= 2020) %>%
select(-c(scenario, future_variability, future_value))
test_costs_only_discount <- test_costs_only %>%
filter(discount == "undiscounted")
test_costs_only_undiscount_tests <- test_costs_only_discount %>%
filter(indicator %in% c("cost_general_hts_neg",
"cost_general_hts_pos",
"cost_anc_test_neg",
"cost_anc_test_pos")) %>%
mutate(mean_test = case_when(
indicator == "cost_general_hts_neg" ~ (mean / 3.62),
indicator == "cost_general_hts_pos" ~ (mean / 5.20),
indicator == "cost_anc_test_neg" ~ (mean / 3.16),
indicator == "cost_anc_test_pos" ~ (mean / 4.72)),
lower_CI_test = case_when(
indicator == "cost_general_hts_neg" ~ (lower_CI / 3.62),
indicator == "cost_general_hts_pos" ~ (lower_CI / 5.20),
indicator == "cost_anc_test_neg" ~ (lower_CI / 3.16),
indicator == "cost_anc_test_pos" ~ (lower_CI / 4.72)),
upper_CI_test = case_when(
indicator == "cost_general_hts_neg" ~ (upper_CI / 3.62),
indicator == "cost_general_hts_pos" ~ (upper_CI / 5.20),
indicator == "cost_anc_test_neg" ~ (upper_CI / 3.16),
indicator == "cost_anc_test_pos" ~ (upper_CI / 4.72))
)
test_diag_pos <- test_costs_only_undiscount_tests %>%
pivot_wider(names_from = indicator, values_from = mean_test) %>%
mutate(gen_total = (cost_general_hts_neg + cost_general_hts_pos)) %>%
mutate(anc_total = (cost_anc_test_neg + cost_anc_test_pos)) %>%
mutate(gen_positivity =(cost_general_hts_pos / gen_total),
anc_positivity = (cost_anc_test_pos/ anc_total))
View(cost_summary)
View(test_diag_pos)
test_diag_pos <- test_costs_only_undiscount_tests %>%
select(-c(mean, lower_CI, upper_CI)) %>%
pivot_wider(names_from = indicator, values_from = mean_test) %>%
mutate(gen_total = (cost_general_hts_neg + cost_general_hts_pos)) %>%
mutate(anc_total = (cost_anc_test_neg + cost_anc_test_pos)) %>%
mutate(gen_positivity =(cost_general_hts_pos / gen_total),
anc_positivity = (cost_anc_test_pos/ anc_total))
test_diag_pos <- test_costs_only_undiscount_tests %>%
select(-c(mean, lower_CI, upper_CI)) %>%
pivot_wider(names_from = indicator, values_from = c(mean_test, lower_CI_test, upper_CI_test)) %>%
mutate(gen_total = (cost_general_hts_neg + cost_general_hts_pos)) %>%
mutate(anc_total = (cost_anc_test_neg + cost_anc_test_pos)) %>%
mutate(gen_positivity =(cost_general_hts_pos / gen_total),
anc_positivity = (cost_anc_test_pos/ anc_total))
test_diag_pos <- test_costs_only_undiscount_tests %>%
select(-c(mean, lower_CI, upper_CI)) %>%
pivot_wider(names_from = indicator, values_from = c(mean_test, lower_CI_test, upper_CI_test))
test_diag_pos <- test_costs_only_undiscount_tests %>%
select(-c(mean, lower_CI, upper_CI)) %>%
pivot_wider(names_from = indicator, values_from = c(mean_test, lower_CI_test, upper_CI_test)) %>%
mutate(mean_test_gen_total = (mean_test_cost_general_hts_neg + mean_test_cost_general_hts_pos)) %>%
mutate(mean_test_anc_total = (mean_test_cost_anc_test_neg + mean_test_cost_anc_test_pos)) %>%
mutate(mean_test_gen_positivity =(mean_test_cost_general_hts_pos / mean_test_gen_total),
anc_positivity = (mean_test_cost_anc_test_pos/ mean_test_anc_total))
test_diag_pos <- test_costs_only_undiscount_tests %>%
select(-c(mean, lower_CI, upper_CI)) %>%
pivot_wider(names_from = indicator, values_from = c(mean_test, lower_CI_test, upper_CI_test)) %>%
mutate(mean_test_gen_total = (mean_test_cost_general_hts_neg + mean_test_cost_general_hts_pos)) %>%
mutate(mean_test_anc_total = (mean_test_cost_anc_test_neg + mean_test_cost_anc_test_pos)) %>%
mutate(mean_test_gen_positivity =(mean_test_cost_general_hts_pos / mean_test_gen_total),
mean_test_anc_positivity = (mean_test_cost_anc_test_pos/ mean_test_anc_total)) %>%
mutate(lower_CI_gen_total = (lower_CI_cost_general_hts_neg + lower_CI_cost_general_hts_pos)) %>%
mutate(lower_CI_anc_total = (lower_CI_cost_anc_test_neg + lower_CI_cost_anc_test_pos)) %>%
mutate(lower_CI_gen_positivity =(lower_CI_cost_general_hts_pos / lower_CI_gen_total),
lower_CI_anc_positivity = (lower_CI_cost_anc_test_pos/ lower_CI_anc_total)) %>%
mutate(upper_CI_gen_total = (upper_CI_cost_general_hts_neg + upper_CI_cost_general_hts_pos)) %>%
mutate(upper_CI_anc_total = (upper_CI_cost_anc_test_neg + upper_CI_cost_anc_test_pos)) %>%
mutate(upper_CI_gen_positivity =(upper_CI_cost_general_hts_pos / upper_CI_gen_total),
upper_CI_anc_positivity = (upper_CI_cost_anc_test_pos/ upper_CI_anc_total))
test_diag_pos <- test_costs_only_undiscount_tests %>%
select(-c(mean, lower_CI, upper_CI)) %>%
pivot_wider(names_from = indicator, values_from = c(mean_test, lower_CI_test, upper_CI_test)) %>%
mutate(mean_test_gen_total = (mean_test_cost_general_hts_neg + mean_test_cost_general_hts_pos)) %>%
mutate(mean_test_anc_total = (mean_test_cost_anc_test_neg + mean_test_cost_anc_test_pos)) %>%
mutate(mean_test_gen_positivity =(mean_test_cost_general_hts_pos / mean_test_gen_total),
mean_test_anc_positivity = (mean_test_cost_anc_test_pos/ mean_test_anc_total)) %>%
mutate(lower_CI_test_gen_total = (lower_CI_test_cost_general_hts_neg + lower_CI_test_cost_general_hts_pos)) %>%
mutate(lower_CI_test_anc_total = (lower_CI_test_cost_anc_test_neg + lower_CI_test_cost_anc_test_pos)) %>%
mutate(lower_CI_test_gen_positivity =(lower_CI_test_cost_general_hts_pos / lower_CI_test_gen_total),
lower_CI_test_anc_positivity = (lower_CI_test_cost_anc_test_pos/ lower_CI_test_anc_total)) %>%
mutate(upper_CI_test_gen_total = (upper_CI_test_cost_general_hts_neg + upper_CI_test_cost_general_hts_pos)) %>%
mutate(upper_CI_test_anc_total = (upper_CI_test_cost_anc_test_neg + upper_CI_test_cost_anc_test_pos)) %>%
mutate(upper_CI_test_gen_positivity =(upper_CI_test_cost_general_hts_pos / upper_CI_test_gen_total),
upper_CI_test_anc_positivity = (upper_CI_test_cost_anc_test_pos/ upper_CI_anc_total))
test_diag_pos <- test_costs_only_undiscount_tests %>%
select(-c(mean, lower_CI, upper_CI)) %>%
pivot_wider(names_from = indicator, values_from = c(mean_test, lower_CI_test, upper_CI_test)) %>%
mutate(mean_test_gen_total = (mean_test_cost_general_hts_neg + mean_test_cost_general_hts_pos)) %>%
mutate(mean_test_anc_total = (mean_test_cost_anc_test_neg + mean_test_cost_anc_test_pos)) %>%
mutate(mean_test_gen_positivity =(mean_test_cost_general_hts_pos / mean_test_gen_total),
mean_test_anc_positivity = (mean_test_cost_anc_test_pos/ mean_test_anc_total)) %>%
mutate(lower_CI_test_gen_total = (lower_CI_test_cost_general_hts_neg + lower_CI_test_cost_general_hts_pos)) %>%
mutate(lower_CI_test_anc_total = (lower_CI_test_cost_anc_test_neg + lower_CI_test_cost_anc_test_pos)) %>%
mutate(lower_CI_test_gen_positivity =(lower_CI_test_cost_general_hts_pos / lower_CI_test_gen_total),
lower_CI_test_anc_positivity = (lower_CI_test_cost_anc_test_pos/ lower_CI_test_anc_total)) %>%
mutate(upper_CI_test_gen_total = (upper_CI_test_cost_general_hts_neg + upper_CI_test_cost_general_hts_pos)) %>%
mutate(upper_CI_test_anc_total = (upper_CI_test_cost_anc_test_neg + upper_CI_test_cost_anc_test_pos)) %>%
mutate(upper_CI_test_gen_positivity =(upper_CI_test_cost_general_hts_pos / upper_CI_test_gen_total),
upper_CI_test_anc_positivity = (upper_CI_test_cost_anc_test_pos/ upper_CI_test_anc_total))
test_diag_pos <- test_costs_only_undiscount_tests %>%
select(-c(mean, lower_CI, upper_CI)) %>%
pivot_longer(cols = c(mean_test, upper_CI_test, lower_CI_test)) %>%
pivot_wider(names_from = indicator)
View(test_diag_pos)
mutate(gen_total = (cost_general_hts_neg + cost_general_hts_pos)) %>%
mutate(anc_total = (cost_anc_test_neg + cost_anc_test_pos)) %>%
mutate(gen_positivity =(general_hts_pos / gen_total),
anc_positivity = (cost_anc_test_pos/ anc_total))
mutate(gen_total = (cost_general_hts_neg + cost_general_hts_pos)) %>%
mutate(anc_total = (cost_anc_test_neg + cost_anc_test_pos)) %>%
mutate(gen_positivity =(cost_general_hts_pos / gen_total),
anc_positivity = (cost_anc_test_pos/ anc_total))
test_diag_pos <- test_costs_only_undiscount_tests %>%
select(-c(mean, lower_CI, upper_CI)) %>%
pivot_longer(cols = c(mean_test, upper_CI_test, lower_CI_test)) %>%
pivot_wider(names_from = indicator) %>%
mutate(gen_total = (cost_general_hts_neg + cost_general_hts_pos)) %>%
mutate(anc_total = (cost_anc_test_neg + cost_anc_test_pos)) %>%
mutate(gen_positivity =(cost_general_hts_pos / gen_total),
anc_positivity = (cost_anc_test_pos/ anc_total))
test_diag_pos <- test_costs_only_undiscount_tests %>%
select(-c(mean, lower_CI, upper_CI)) %>%
pivot_longer(cols = c(mean_test, upper_CI_test, lower_CI_test)) %>%
pivot_wider(names_from = indicator) %>%
mutate(gen_total = (cost_general_hts_neg + cost_general_hts_pos)) %>%
mutate(anc_total = (cost_anc_test_neg + cost_anc_test_pos)) %>%
mutate(gen_positivity =(cost_general_hts_pos / gen_total),
anc_positivity = (cost_anc_test_pos/ anc_total)) %>%
pivot_longer(cols = year:discount, names_to = "indicator")
test_diag_pos <- test_costs_only_undiscount_tests %>%
select(-c(mean, lower_CI, upper_CI)) %>%
pivot_longer(cols = c(mean_test, upper_CI_test, lower_CI_test)) %>%
pivot_wider(names_from = indicator) %>%
mutate(gen_total = (cost_general_hts_neg + cost_general_hts_pos)) %>%
mutate(anc_total = (cost_anc_test_neg + cost_anc_test_pos)) %>%
mutate(gen_positivity =(cost_general_hts_pos / gen_total),
anc_positivity = (cost_anc_test_pos/ anc_total)) %>%
pivot_longer(-(year:discount), names_to = "indicator")
test_diag_pos <- test_costs_only_undiscount_tests %>%
select(-c(mean, lower_CI, upper_CI)) %>%
pivot_longer(cols = c(mean_test, upper_CI_test, lower_CI_test)) %>%
pivot_wider(names_from = indicator) %>%
mutate(gen_total = (cost_general_hts_neg + cost_general_hts_pos)) %>%
mutate(anc_total = (cost_anc_test_neg + cost_anc_test_pos)) %>%
mutate(gen_positivity =(cost_general_hts_pos / gen_total),
anc_positivity = (cost_anc_test_pos/ anc_total)) %>%
pivot_longer(-(year:name), names_to = "indicator")
test_diag_pos <- test_costs_only_undiscount_tests %>%
select(-c(mean, lower_CI, upper_CI)) %>%
pivot_longer(cols = c(mean_test, upper_CI_test, lower_CI_test)) %>%
pivot_wider(names_from = indicator) %>%
mutate(gen_total = (cost_general_hts_neg + cost_general_hts_pos)) %>%
mutate(anc_total = (cost_anc_test_neg + cost_anc_test_pos)) %>%
mutate(gen_positivity =(cost_general_hts_pos / gen_total),
anc_positivity = (cost_anc_test_pos/ anc_total)) %>%
pivot_longer(-(year:name), names_to = "indicator") %>%
pivot_wider()
test_diag_pos %>%
filter(indicator %in% c("gen_total",
"anc_total",
"gen_positivity",
"anc_positivity"),
test_reduction %in% c(0, 25, 50, 75, 100)) %>%
mutate(test_reduction = as.factor(test_reduction)) %>%
ggplot(aes(year, mean_test, group = test_reduction)) +
geom_ribbon(aes(ymin = lower_CI_test, ymax = upper_CI_test, fill = test_reduction), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = test_reduction), show.legend = T) +
scale_x_continuous("",expand = c(0, 0)) +
theme_classic() +
theme(axis.text = element_text(size = 11),
axis.title.y = element_text(size = 11),
axis.title.x = element_text(size = 11),
legend.text = element_text(size = 11),
plot.title = element_text(size = 12, face = "bold", hjust = 0.5),
aspect.ratio=1,
legend.title = element_text(size = 11)) +
scale_y_continuous("Number of tests (millions)", labels =(function(l) {round(l/10^6,2)}), expand = c(0,0)) +
scale_fill_brewer("General\nHTS\nreduction", labels = c("None\n(Status quo)", "25%", "50%", "75%", "100%"),
aesthetics = c("colour", "fill"), palette = "Set1") +
ggtitle("Annual number of positive and negative tests") +
facet_wrap(~indicator, scales = "free_y", labeller = as_labeller(c("gen_total" = "Total general HIV tests",
"anc_total" = "Total ANC HIV tests",
"gen_positivity" = "General positivity",
"anc_positivity" = "ANC positivity")))
test_diag_pos %>%
filter(indicator %in% c("gen_total",
"anc_total"),
test_reduction %in% c(0, 25, 50, 75, 100)) %>%
mutate(test_reduction = as.factor(test_reduction)) %>%
ggplot(aes(year, mean_test, group = test_reduction)) +
geom_ribbon(aes(ymin = lower_CI_test, ymax = upper_CI_test, fill = test_reduction), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = test_reduction), show.legend = T) +
scale_x_continuous("",expand = c(0, 0)) +
theme_classic() +
theme(axis.text = element_text(size = 11),
axis.title.y = element_text(size = 11),
axis.title.x = element_text(size = 11),
legend.text = element_text(size = 11),
plot.title = element_text(size = 12, face = "bold", hjust = 0.5),
aspect.ratio=1,
legend.title = element_text(size = 11)) +
scale_y_continuous("Number of tests (millions)", labels =(function(l) {round(l/10**6,2)}), expand = c(0,0)) +
scale_fill_brewer("General\nHTS\nreduction", labels = c("None\n(Status quo)", "25%", "50%", "75%", "100%"),
aesthetics = c("colour", "fill"), palette = "Set1") +
ggtitle("Annual number of positive and negative tests") +
facet_wrap(~indicator, scales = "free_y", labeller = as_labeller(c("gen_total" = "Total general HIV tests",
"anc_total" = "Total ANC HIV tests",
"gen_positivity" = "General positivity",
"anc_positivity" = "ANC positivity")))
test_diag_pos %>%
filter(indicator %in% c("gen_total",
"anc_total"),
test_reduction %in% c(0, 25, 50, 75, 100)) %>%
mutate(test_reduction = as.factor(test_reduction)) %>%
ggplot(aes(year, mean_test, group = test_reduction)) +
geom_ribbon(aes(ymin = lower_CI_test, ymax = upper_CI_test, fill = test_reduction), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = test_reduction), show.legend = T) +
scale_x_continuous("",expand = c(0, 0)) +
theme_classic() +
theme(axis.text = element_text(size = 11),
axis.title.y = element_text(size = 11),
axis.title.x = element_text(size = 11),
legend.text = element_text(size = 11),
plot.title = element_text(size = 12, face = "bold", hjust = 0.5),
aspect.ratio=1,
legend.title = element_text(size = 11)) +
scale_y_continuous("Number of tests (millions)", labels =(function(l) {round(l/10**6,2)}), expand = c(0,0)) +
scale_fill_brewer("General\nHTS\nreduction", labels = c("None\n(Status quo)", "25%", "50%", "75%", "100%"),
aesthetics = c("colour", "fill"), palette = "Set1") +
ggtitle("Annual number HIV tests") +
facet_wrap(~indicator, scales = "free_y", labeller = as_labeller(c("gen_total" = "Total general HIV tests",
"anc_total" = "Total ANC HIV tests",
"gen_positivity" = "General positivity",
"anc_positivity" = "ANC positivity")))
test_diag_pos %>%
filter(indicator %in% c("gen_total",
"anc_total"),
test_reduction %in% c(0, 25, 50, 75, 100)) %>%
mutate(test_reduction = as.factor(test_reduction)) %>%
ggplot(aes(year, mean_test, group = test_reduction)) +
geom_ribbon(aes(ymin = lower_CI_test, ymax = upper_CI_test, fill = test_reduction), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = test_reduction), show.legend = T) +
scale_x_continuous("",expand = c(0, 0)) +
theme_classic() +
theme(axis.text = element_text(size = 11),
axis.title.y = element_text(size = 11),
axis.title.x = element_text(size = 11),
legend.text = element_text(size = 11),
plot.title = element_text(size = 12, face = "bold", hjust = 0.5),
aspect.ratio=1,
legend.title = element_text(size = 11),
strip.background = element_blank(),
strip.text = element_text(size = 12)) +
scale_y_continuous("Number of tests (millions)", labels =(function(l) {round(l/10**6,2)}), expand = c(0,0)) +
scale_fill_brewer("General\nHTS\nreduction", labels = c("None\n(Status quo)", "25%", "50%", "75%", "100%"),
aesthetics = c("colour", "fill"), palette = "Set1") +
ggtitle("Annual number HIV tests") +
facet_wrap(~indicator, scales = "free_y", labeller = as_labeller(c("gen_total" = "Total general HIV tests",
"anc_total" = "Total ANC HIV tests",
"gen_positivity" = "General positivity",
"anc_positivity" = "ANC positivity")))
test_diag_pos %>%
filter(indicator %in% c("gen_total",
"anc_total"),
test_reduction %in% c(0, 25, 50, 75, 100)) %>%
mutate(test_reduction = as.factor(test_reduction)) %>%
ggplot(aes(year, mean_test, group = test_reduction)) +
geom_ribbon(aes(ymin = lower_CI_test, ymax = upper_CI_test, fill = test_reduction), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = test_reduction), show.legend = T) +
scale_x_continuous("",expand = c(0, 0)) +
theme_classic() +
theme(axis.text = element_text(size = 11),
axis.title.y = element_text(size = 11),
axis.title.x = element_text(size = 11),
legend.text = element_text(size = 11),
plot.title = element_text(size = 12, face = "bold", hjust = 0.5),
aspect.ratio=1,
legend.title = element_text(size = 11),
strip.background = element_blank(),
strip.text = element_text(size = 11)) +
scale_y_continuous("Number of tests (millions)", labels =(function(l) {round(l/10**6,2)}), expand = c(0,0)) +
scale_fill_brewer("General\nHTS\nreduction", labels = c("None\n(Status quo)", "25%", "50%", "75%", "100%"),
aesthetics = c("colour", "fill"), palette = "Set1") +
ggtitle("Annual number HIV tests") +
facet_wrap(~indicator, scales = "free_y", labeller = as_labeller(c("gen_total" = "Total general HIV tests",
"anc_total" = "Total ANC HIV tests",
"gen_positivity" = "General positivity",
"anc_positivity" = "ANC positivity")))
test_diag_pos %>%
filter(indicator %in% c("gen_total",
"anc_total"),
test_reduction %in% c(0, 25, 50, 75, 100)) %>%
mutate(test_reduction = as.factor(test_reduction)) %>%
ggplot(aes(year, mean_test, group = test_reduction)) +
geom_ribbon(aes(ymin = lower_CI_test, ymax = upper_CI_test, fill = test_reduction), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = test_reduction), show.legend = T) +
scale_x_continuous("",expand = c(0, 0)) +
theme_classic() +
theme(axis.text = element_text(size = 11),
axis.title.y = element_text(size = 11),
axis.title.x = element_text(size = 11),
legend.text = element_text(size = 11),
plot.title = element_text(size = 12, face = "bold", hjust = 0.5),
aspect.ratio=1,
legend.title = element_text(size = 11),
strip.background = element_blank(),
strip.text = element_text(size = 11)) +
scale_y_continuous("Number of tests (millions)", labels =(function(l) {round(l/10**6,2)}), expand = c(0,0)) +
scale_fill_brewer("General\nHTS\nreduction", labels = c("None\n(Status quo)", "25%", "50%", "75%", "100%"),
aesthetics = c("colour", "fill"), palette = "Set1") +
ggtitle("Annual number HIV tests") +
facet_wrap(~indicator, scales = "free_y", labeller = as_labeller(c("gen_total" = "General adults and children",
"anc_total" = "Pregnant women at ANC",
"gen_positivity" = "General positivity",
"anc_positivity" = "ANC positivity")))
test_diag_pos %>%
filter(indicator %in% c("gen_total",
"anc_total"),
test_reduction %in% c(0, 25, 50, 75, 100)) %>%
mutate(test_reduction = as.factor(test_reduction)) %>%
ggplot(aes(year, mean_test, group = test_reduction)) +
geom_ribbon(aes(ymin = lower_CI_test, ymax = upper_CI_test, fill = test_reduction), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = test_reduction), show.legend = T) +
scale_x_continuous("",expand = c(0, 0)) +
theme_classic() +
theme(axis.text = element_text(size = 11),
axis.title.y = element_text(size = 11),
axis.title.x = element_text(size = 11),
legend.text = element_text(size = 11),
plot.title = element_text(size = 12, face = "bold", hjust = 0.5),
aspect.ratio=1,
legend.title = element_text(size = 11),
strip.text = element_text(size = 11)) +
scale_y_continuous("Number of tests (millions)", labels =(function(l) {round(l/10**6,2)}), expand = c(0,0)) +
scale_fill_brewer("General\nHTS\nreduction", labels = c("None\n(Status quo)", "25%", "50%", "75%", "100%"),
aesthetics = c("colour", "fill"), palette = "Set1") +
ggtitle("Annual number HIV tests") +
facet_wrap(~indicator, scales = "free_y", labeller = as_labeller(c("gen_total" = "General adults and children",
"anc_total" = "Pregnant women at ANC",
"gen_positivity" = "General positivity",
"anc_positivity" = "ANC positivity")))
test_diag_pos %>%
filter(indicator %in% c("gen_total",
"anc_total"),
test_reduction %in% c(0, 25, 50, 75, 100)) %>%
mutate(test_reduction = as.factor(test_reduction)) %>%
ggplot(aes(year, mean_test, group = test_reduction)) +
geom_ribbon(aes(ymin = lower_CI_test, ymax = upper_CI_test, fill = test_reduction), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = test_reduction), show.legend = T) +
scale_x_continuous("",expand = c(0, 0)) +
theme_classic() +
theme(axis.text = element_text(size = 11),
axis.title.y = element_text(size = 11),
axis.title.x = element_text(size = 11),
legend.text = element_text(size = 11),
plot.title = element_text(size = 12, face = "bold", hjust = 0.5),
aspect.ratio=1,
legend.title = element_text(size = 11),
strip.text = element_text(size = 11)) +
scale_y_continuous("Number of tests (millions)", labels =(function(l) {round(l/10**6,2)}), expand = c(0,0)) +
scale_fill_brewer("General\nHTS\nreduction", labels = c("None\n(Status quo)", "25%", "50%", "75%", "100%"),
aesthetics = c("colour", "fill"), palette = "Set1") +
ggtitle("Annual number of HIV tests") +
facet_wrap(~indicator, scales = "free_y", labeller = as_labeller(c("gen_total" = "General adults and children",
"anc_total" = "Pregnant women at ANC",
"gen_positivity" = "General positivity",
"anc_positivity" = "ANC positivity")))
test_diag_pos %>%
filter(indicator %in% c("gen_positivity",
"anc_positivity"),
test_reduction %in% c(0, 25, 50, 75, 100)) %>%
mutate(test_reduction = as.factor(test_reduction)) %>%
ggplot(aes(year, mean_test, group = test_reduction)) +
geom_ribbon(aes(ymin = lower_CI_test, ymax = upper_CI_test, fill = test_reduction), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = test_reduction), show.legend = T) +
scale_x_continuous("",expand = c(0, 0)) +
theme_classic() +
theme(axis.text = element_text(size = 11),
axis.title.y = element_text(size = 11),
axis.title.x = element_text(size = 11),
legend.text = element_text(size = 11),
plot.title = element_text(size = 12, face = "bold", hjust = 0.5),
aspect.ratio=1,
legend.title = element_text(size = 11)) +
scale_y_continuous("Test positivity (%)", labels =(function(l) {round(l/10*2,2)}), expand = c(0,0)) +
scale_fill_brewer("General\nHTS\nreduction", labels = c("None\n(Status quo)", "25%", "50%", "75%", "100%"),
aesthetics = c("colour", "fill"), palette = "Set1") +
ggtitle("Annual test positivity") +
facet_wrap(~indicator, scales = "free_y", labeller = as_labeller(c("gen_total" = "Total general HIV tests",
"anc_total" = "Total ANC HIV tests",
"gen_positivity" = "General positivity",
"anc_positivity" = "ANC positivity")))
test_diag_pos %>%
filter(indicator %in% c("gen_positivity",
"anc_positivity"),
test_reduction %in% c(0, 25, 50, 75, 100)) %>%
mutate(test_reduction = as.factor(test_reduction)) %>%
ggplot(aes(year, mean_test, group = test_reduction)) +
geom_ribbon(aes(ymin = lower_CI_test, ymax = upper_CI_test, fill = test_reduction), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = test_reduction), show.legend = T) +
scale_x_continuous("",expand = c(0, 0)) +
theme_classic() +
theme(axis.text = element_text(size = 11),
axis.title.y = element_text(size = 11),
axis.title.x = element_text(size = 11),
legend.text = element_text(size = 11),
plot.title = element_text(size = 12, face = "bold", hjust = 0.5),
aspect.ratio=1,
legend.title = element_text(size = 11)) +
scale_y_continuous("Test positivity (%)", labels =(function(l) {round(l*10*2,2)}), expand = c(0,0)) +
scale_fill_brewer("General\nHTS\nreduction", labels = c("None\n(Status quo)", "25%", "50%", "75%", "100%"),
aesthetics = c("colour", "fill"), palette = "Set1") +
ggtitle("Annual test positivity") +
facet_wrap(~indicator, scales = "free_y", labeller = as_labeller(c("gen_total" = "Total general HIV tests",
"anc_total" = "Total ANC HIV tests",
"gen_positivity" = "General positivity",
"anc_positivity" = "ANC positivity")))
test_diag_pos %>%
filter(indicator %in% c("gen_positivity",
"anc_positivity"),
test_reduction %in% c(0, 25, 50, 75, 100)) %>%
mutate(test_reduction = as.factor(test_reduction)) %>%
ggplot(aes(year, mean_test, group = test_reduction)) +
geom_ribbon(aes(ymin = lower_CI_test, ymax = upper_CI_test, fill = test_reduction), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = test_reduction), show.legend = T) +
scale_x_continuous("",expand = c(0, 0)) +
theme_classic() +
theme(axis.text = element_text(size = 11),
axis.title.y = element_text(size = 11),
axis.title.x = element_text(size = 11),
legend.text = element_text(size = 11),
plot.title = element_text(size = 12, face = "bold", hjust = 0.5),
aspect.ratio=1,
legend.title = element_text(size = 11),
strip.text = element_text(size = 11)) +
scale_y_continuous("Test positivity (%)", labels =(function(l) {round(l*10*2,2)}), expand = c(0,0)) +
scale_fill_brewer("General\nHTS\nreduction", labels = c("None\n(Status quo)", "25%", "50%", "75%", "100%"),
aesthetics = c("colour", "fill"), palette = "Set1") +
ggtitle("Annual test positivity") +
facet_wrap(~indicator, scales = "free_y", labeller = as_labeller(c("gen_total" = "Total general HIV tests",
"anc_total" = "Total ANC HIV tests",
"gen_positivity" = "General positivity",
"anc_positivity" = "ANC positivity")))
library(cowplot)
library(ggplot2)
library(gridExtra)
test_diag_pos %>%
filter(indicator %in% c("gen_total",
"anc_total"),
test_reduction %in% c(0, 25, 50, 75, 100)) %>%
mutate(test_reduction = as.factor(test_reduction)) %>%
ggplot(aes(year, mean_test, group = test_reduction)) +
geom_ribbon(aes(ymin = lower_CI_test, ymax = upper_CI_test, fill = test_reduction), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = test_reduction), show.legend = T) +
scale_x_continuous("",expand = c(0, 0)) +
theme_classic() +
theme(axis.text = element_text(size = 11),
axis.title.y = element_text(size = 11),
axis.title.x = element_text(size = 11),
legend.text = element_text(size = 11),
plot.title = element_text(size = 12, face = "bold", hjust = 0.5),
aspect.ratio=1,
legend.title = element_text(size = 11),
strip.text = element_text(size = 11)) +
scale_y_continuous("Number of tests (millions)", labels =(function(l) {round(l/10**6,2)}), expand = c(0,0)) +
scale_fill_brewer("General\nHTS\nreduction", labels = c("None\n(Status quo)", "25%", "50%", "75%", "100%"),
aesthetics = c("colour", "fill"), palette = "Set1") +
ggtitle("Annual number of HIV tests") +
facet_wrap(~indicator, scales = "free_y", labeller = as_labeller(c("gen_total" = "General adults and children",
"anc_total" = "Pregnant women at ANC",
"gen_positivity" = "General positivity",
"anc_positivity" = "ANC positivity")))
test_diag_pos %>%
filter(indicator %in% c("gen_positivity",
"anc_positivity"),
test_reduction %in% c(0, 25, 50, 75, 100)) %>%
mutate(test_reduction = as.factor(test_reduction)) %>%
ggplot(aes(year, mean_test, group = test_reduction)) +
geom_ribbon(aes(ymin = lower_CI_test, ymax = upper_CI_test, fill = test_reduction), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = test_reduction), show.legend = T) +
scale_x_continuous("",expand = c(0, 0)) +
theme_classic() +
theme(axis.text = element_text(size = 11),
axis.title.y = element_text(size = 11),
axis.title.x = element_text(size = 11),
legend.text = element_text(size = 11),
plot.title = element_text(size = 12, face = "bold", hjust = 0.5),
aspect.ratio=1,
legend.title = element_text(size = 11),
strip.text = element_text(size = 11)) +
scale_y_continuous("Test positivity (%)", labels =(function(l) {round(l*10*2,2)}), expand = c(0,0)) +
scale_fill_brewer("General\nHTS\nreduction", labels = c("None\n(Status quo)", "25%", "50%", "75%", "100%"),
aesthetics = c("colour", "fill"), palette = "Set1") +
ggtitle("Annual test positivity") +
facet_wrap(~indicator, scales = "free_y", labeller = as_labeller(c("gen_total" = "Total general HIV tests",
"anc_total" = "Total ANC HIV tests",
"gen_positivity" = "General positivity",
"anc_positivity" = "ANC positivity")))
