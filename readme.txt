Contents of SA_longterm_HTS

This repo contains all the code necessary to reproduce the results in the paper, "Future HIV epidemic trajectories in South Africa and projected long-term consequences of reductions in general population HIV testing: a mathematical modelling study" by Rautenbach et al., 2024. The THEMBISAv18 folder contains all the model’s txt files which define the parameters, the C++ code (.cpp and .h) for the model and the txt outputs (for each model run). These have been edited to be able and will therefore only run on MacOS or a similar OS. There is a unix executable file (“thembisa”) which is the compiled model. 

The markdown, "running_scenarios.Rmd" will allow for each scenario to be recreated. 

The other markdowns "cleaning_csv_dfs.Rmd"There are some additional files/folders which are mostly backups or relevant to the Microsoft Visual Basic version of the model. I have retained them in case they are used elsewhere. Running THEMBISA on Unix-like systemThese are all the steps that I took to run the model on my computer. Not all of them will be necessary. If you already have homebrew or gcc installed then check that both are up to date and continue from step 3. 1. Install homebrew Type the following into the CLT (see https://brew.sh/ for more details):/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)" 2. In the bash shell type the following:export HOMEBREW_NO_ANALYTICS=1brew updatebrew upgradebrew info gccbrew install gccbrew cleanup 	(this removes previous application/dependency revisions saving considerable space)This will install gcc3. To run programs in gcc you need to change the directory to the local folder you have the Thembisa.cpp and Thembisa.h files inFor example:cd /Users/stefanrautenbach/Documents/Imperial/Research_project/THEMBISAv184. Compile Thembisa by running the following code:g++ -std=c++14 THEMBISA.cpp StatFunctions.cpp mersenne.cpp -o thembisa -O2This should create a unix executable file in the same folder5. To run the model type: ./thembisaThis will take about 45min to an hour to run and should output the following:Read input filesCompleted simulation 100Completed simulation 200Completed simulation 300Completed simulation 400Completed simulation 500Completed simulation 600Completed simulation 700Completed simulation 800Completed simulation 900Completed simulation 1000Changing parameter valuesIn ‘Thembisa.h’ many of the parameter values are defined. This includes the number of years for which to project results (currently set to 46 i.e. up to and include 2030). Many parameters can be toggled on or off by changing from 0 to 1. Others will need to be adjusted in the parameter specific txt file. 